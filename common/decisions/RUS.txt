preparing_the_revolution = {

		saint_petersburg_hq = {
			visible = {
				NOT = {
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 384
			}
			complete_effect = {
				set_country_flag = RUS_saint_petersburg_hq_FLG
				384 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				384 = {
					add_core_of = RST
				}
			}
		}

		moscow_hq = {
			visible = {
				NOT = {
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 390
			}

			complete_effect = {
				set_country_flag = RUS_moscow_hq_FLG
				390 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				390 = {
					add_core_of = RST
				}
			}
		}

		tsaritsyn_hq = {
			visible = {
				NOT = {
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 389
			}

			complete_effect = {
				set_country_flag = RUS_tsaritsyn_hq_FLG
				389 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				389 = {
					add_core_of = RST
				}
			}
		}

		ekaterinburg_hq = {
			visible = {
				NOT = {
					OR = {
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 382
			}

			complete_effect = {
				set_country_flag = RUS_ekaterinburg_hq_FLG
				382 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				382 = {
					add_core_of = RST
				}
			}
		}

		irkutsk_hq = {
			visible = {
				NOT = {
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 368
			}

			complete_effect = {
				set_country_flag = RUS_irkutsk_hq_FLG
				368 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				368 = {
					add_core_of = RST
				}
			}
		}

		saint_petersburg_second_hq = {
			visible = {
				AND = {
					NOT = {
						OR = {
							has_country_flag = RUS_ekaterinburg_hq_2_FLG
							has_country_flag = RUS_tsaritsyn_hq_2_FLG
							has_country_flag = RUS_irkutsk_hq_2_FLG
							has_country_flag = RUS_moscow_hq_2_FLG
							has_country_flag = RUS_saint_petersburg_hq_FLG
						}
					}
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 384
			}

			complete_effect = {
				set_country_flag = RUS_saint_petersburg_hq_2_FLG
				384 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				384 = {
					add_core_of = RST
				}
			}
		}

		moscow_second_hq = {
			visible = {
				AND = {
					NOT = {
						OR = {
							has_country_flag = RUS_ekaterinburg_hq_2_FLG
							has_country_flag = RUS_tsaritsyn_hq_2_FLG
							has_country_flag = RUS_irkutsk_hq_2_FLG
							has_country_flag = RUS_moscow_hq_FLG
							has_country_flag = RUS_saint_petersburg_hq_2_FLG
						}
					}
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 390
			}

			complete_effect = {
				set_country_flag = RUS_moscow_hq_2_FLG
				390 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				390 = {
					add_core_of = RST
				}
			}
		}

		tsaritsyn_second_hq = {
			visible = {
				AND = {
					NOT = {
						OR = {
							has_country_flag = RUS_ekaterinburg_hq_2_FLG
							has_country_flag = RUS_tsaritsyn_hq_2_FLG
							has_country_flag = RUS_irkutsk_hq_FLG
							has_country_flag = RUS_moscow_hq_2_FLG
							has_country_flag = RUS_saint_petersburg_hq_2_FLG
						}
					}
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 389
			}

			complete_effect = {
				set_country_flag = RUS_tsaritsyn_hq_2_FLG
				389 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				389 = {
					add_core_of = RST
				}
			}
		}

		ekaterinburg_second_hq = {
			visible = {
				AND = {
					NOT = {
						OR = {
							has_country_flag = RUS_ekaterinburg_hq_FLG
							has_country_flag = RUS_tsaritsyn_hq_2_FLG
							has_country_flag = RUS_irkutsk_hq_2_FLG
							has_country_flag = RUS_moscow_hq_2_FLG
							has_country_flag = RUS_saint_petersburg_hq_2_FLG
						}
					}
					OR = {
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 382
			}

			complete_effect = {
				set_country_flag = RUS_ekaterinburg_hq_2_FLG
				382 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				382 = {
					add_core_of = RST
				}
			}
		}

		irkutsk_second_hq = {
			visible = {
				AND = {
					NOT = {
						OR = {
							has_country_flag = RUS_ekaterinburg_hq_2_FLG
							has_country_flag = RUS_tsaritsyn_hq_2_FLG
							has_country_flag = RUS_irkutsk_hq_FLG
							has_country_flag = RUS_moscow_hq_2_FLG
							has_country_flag = RUS_saint_petersburg_hq_2_FLG
						}
					}
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
					}
				}
			}
			icon = GFX_decision_category_generic_communism
			on_map_mode = map_only
			fire_only_once = yes

			highlight_states = {
				state = 368
			}

			complete_effect = {
				set_country_flag = RUS_irkutsk_hq_2_FLG
				368 = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				368 = {
					add_core_of = RST
				}
			}
		}

		entrench_the_revolution = {
			visible = {
				AND = {
					OR = {
						has_country_flag = RUS_ekaterinburg_hq_FLG
						has_country_flag = RUS_tsaritsyn_hq_FLG
						has_country_flag = RUS_saint_petersburg_hq_FLG
						has_country_flag = RUS_moscow_hq_FLG
						has_country_flag = RUS_irkutsk_hq_FLG
					}
					NOT = {
						FROM = {
							has_state_flag = RUS_revolution_mark_FLG
						}
					}
				}
			}
			icon = GFX_decision_infiltrate_state
			on_map_mode = map_only
			state_target = yes
			cost = 20

			target_array = owned_states
			target_trigger = {
				FROM = {
					any_neighbor_state = {
						has_state_flag = RUS_revolution_mark_FLG
					}
				}
			}

			available = {
				NOT = {
					OR = {
						FROM = {
							has_state_flag = RUS_revolution_crackdown_FLG
						}
						FROM = {
							is_core_of = TRN
						}
					}
				}
			}

			complete_effect = {
				FROM = {
					set_state_flag = RUS_revolution_mark_FLG
				}
				RST = {
					add_state_core = FROM
				}
			}
		}

}

the_russian_civil_war = { 		 ###These decisions include the civil war mission timer, and decisions/unlocks that affect said timer.
		the_inevitable_war = {	 ###Seeing these decisions will be dependent on the flag set by the first focus in each tree, so if
			available = {		 ###someone decides not to do their tree, the civil war WILL fire, but they won't get the decisions.
				custom_trigger_tooltip = {
					tooltip = tt_RUS_the_inevitable_war
					always = no
				}
			}
			priority = 10
			activation = {
				has_country_flag = RUS_the_inevitable_war_FLG
			}
			is_good = no
			days_mission_timeout = 365
			timeout_effect = {
				custom_effect_tooltip = tt_RUS_russian_civil_war
				hidden_effect = {
					remove_ideas = RUS_bolster_public_support
					set_global_flag = RUS_civil_war_FLG
					TRN = {
						transfer_state = 447
						transfer_state = 443
						transfer_state = 441
						transfer_state = 1000
						transfer_state = 449
						transfer_state = 1005
					}
					division_template = {
						name = "Imperial Militia"
						is_locked = yes
						division_names_group = SOV_INF_01
						priority = 0
						template_counter = 0
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
						}
					}
					RST = {
						division_template = {
							name = "Red Militia"
							is_locked = yes
							division_names_group = SOV_INF_01
							priority = 0
							template_counter = 0
							regiments = {
								infantry = { x = 0 y = 0 }
								infantry = { x = 0 y = 1 }
								infantry = { x = 0 y = 2 }
								infantry = { x = 1 y = 0 }
								infantry = { x = 1 y = 1 }
								infantry = { x = 1 y = 2 }
							}
						}
						if = {
							limit = {
								RUS = {
									has_completed_focus = RUS_unite_the_revolutionaries
								}
							}
							set_stability = 0.7
						}
						else = {
							set_stability = 0.5
							add_ideas = RUS_clashing_revolutions
						}
					}
					every_owned_state = {
						limit = {
							has_state_flag = RUS_revolution_mark_FLG
						}
						RST = {
							transfer_state = PREV
						}
						create_unit = {
							division = "division_template = \"Red Militia\" start_experience_factor = 0.1" 
							owner = RST
							allow_spawning_on_enemy_provs = yes
							count = 2
						}
					}
					if = {
						limit = {
							has_completed_focus = RUS_military_sympathies
						}
						transfer_units_fraction = {
							target = RST
							size = 0.5
							stockpile_ratio = 0.8
							army_ratio = 0.8
							navy_ratio = 0.5
							air_ratio = 0.5
							keep_unit_leaders_trigger = {
								### has_trait = #insert custom leader trait for revolutionary sympathies#
							}
						}
					}
					else = {
						transfer_units_fraction = {
							target = RST
							size = 0.5
							stockpile_ratio = 0.5
							army_ratio = 0.5
							navy_ratio = 0.5
							air_ratio = 0.5
							keep_unit_leaders_trigger = {
								### has_trait = #insert custom leader trait for revolutionary sympathies#
							}
						}
					}
					if = {
						limit = {
							has_completed_focus = RUS_the_red_army
						}
						RST = {
							division_template = {
								name = "Red Infantry"
								is_locked = yes
								division_names_group = SOV_INF_01
								priority = 2
								template_counter = 1
								regiments = {
									infantry = { x = 0 y = 0 }
									infantry = { x = 0 y = 1 }
									infantry = { x = 0 y = 2 }
									infantry = { x = 1 y = 0 }
									infantry = { x = 1 y = 1 }
									infantry = { x = 1 y = 2 }
									infantry = { x = 2 y = 0 }
									artillery_brigade = { x = 2 y = 1 }
									artillery_brigade = { x = 2 y = 2 }
								}
								support = {
									recon = { x = 0 y = 0 }
									engineer = { x = 0 y = 1 }
								}
							}
							random_owned_controlled_state = {
								create_unit = {
									division = "division_template = \"Red Infantry\" start_experience_factor = 0.1"
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 2
								}
							}
							random_owned_controlled_state = {
								create_unit = {
									division = "division_template = \"Red Infantry\" start_experience_factor = 0.1"
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 2
								}
							}
							random_owned_controlled_state = {
								create_unit = {
									division = "division_template = \"Red Infantry\" start_experience_factor = 0.1"
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 2
								}
							}
						}
					}
					if = {
						limit = {
							has_completed_focus = RUS_the_red_militias
						}
						RST = {
							random_owned_controlled_state = {
								limit = {
									has_state_flag = RUS_revolution_mark_FLG
								}
								create_unit = {
									division = "division_template = \"Red Militia\" start_experience_factor = 0.1" 
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 4
								}
							}
							random_owned_controlled_state = {
								limit = {
									has_state_flag = RUS_revolution_mark_FLG
								}
								create_unit = {
									division = "division_template = \"Red Militia\" start_experience_factor = 0.1" 
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 4
								}
							}
							random_owned_controlled_state = {
								limit = {
									has_state_flag = RUS_revolution_mark_FLG
								}
								create_unit = {
									division = "division_template = \"Red Militia\" start_experience_factor = 0.1" 
									owner = RST
									allow_spawning_on_enemy_provs = yes
									count = 4
								}
							}
						}
					}
					every_owned_state = {
						limit = {
							NOT = {
								has_state_flag = RUS_revolution_mark_FLG
							}
						}
						create_unit = {
							division = "division_template = \"Imperial Militia\" start_experience_factor = 0.1"
							owner = RUS
							allow_spawning_on_enemy_provs = yes
							count = 1
						}
					}
					if = {
						limit = {
							has_country_flag = RUS_popular_revolution_FLG
						}
						RST = {
							change_tag_from = ROOT
						}
					}
					declare_war_on = {
						target = RST
						type = annex_everything
					}
				}
			}
		}

		debug_speed_civil_war = {
			cost = 0
			complete_effect = {
				add_days_mission_timeout = {
					mission = the_inevitable_war
					days = -370
				}
			}
		}
}